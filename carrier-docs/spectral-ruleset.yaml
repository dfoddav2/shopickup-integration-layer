extends: "spectral:oas"
rules:
  shopickup-required-post-parcel:
    description: "POST /api/parcel must be present"
    given: "$.paths['/api/parcel'].post"
    then:
      function: truthy

  shopickup-required-get-tracking:
    description: "GET /api/tracking/{barcode} must be present"
    given: "$.paths['/api/tracking/{barcode}'].get"
    then:
      function: truthy

  shopickup-required-post-label:
    description: "POST /api/label/{pageSize} must be present"
    given: "$.paths['/api/label/{pageSize}'].post"
    then:
      function: truthy

  shopickup-basic-auth-present:
    description: "Spec must declare basicAuth in components.securitySchemes"
    given: "$.components.securitySchemes.basicAuth"
    then:
      function: truthy

  shopickup-parcel-api-key-param:
    description: "POST /api/parcel must include an api-key or API-Key header parameter"
    given: "$.paths['/api/parcel'].post.parameters[?(@.name=='api-key' || @.name=='API-Key')]"
    then:
      function: truthy